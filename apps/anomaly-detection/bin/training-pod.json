{
   "id":"/anomaly-training-pod",
   "labels":{
      "pod_label":"pod"
   },
   "environment":{
      "POD_ENV":"pod",
      "DATA_FILE_NAME":"/usr/share/CPU_examples.csv",
      "GENERATION_COMPLETE_FILE_NAME":"/usr/share/data_preparation_complete.txt",
      "MODEL_PB_FILE_NAME":"/usr/share/model.pb",
      "MODEL_ATTRIB_FILE_NAME":"/usr/share/model-attributes.properties",
      "KAFKA_BROKERS":"broker.kafka.l4lb.thisdcos.directory:9092",
      "INFLUXDB_HOST":"influxdb.marathon.l4lb.thisdcos.directory",
      "INFLUXDB_PORT":"8086",
      "INGEST_INTERVAL":"10 minutes",
      "TRAINING_COMPLETE_FILE_NAME":"/usr/share/training_complete.txt",
      "LAST_TIMESTAMP_FILE_NAME":"/usr/share/last_timestamp.txt",
      "HYPERPARAMS_FILE_NAME":"/usr/share/hyperparams.properties",
      "INGEST_THRESHOLD_COUNT":"1024"
   },
   "containers":[
      {
         "name":"generatedata",
         "exec":{
            "command":{
               "shell":"/training_data_ingestion/bin/trainingdataingestion"
            }
         },
         "resources":{
            "cpus":0.5,
            "mem":4096,
            "disk":32
         },
         "endpoints":[
         ],
         "image":{
            "kind":"DOCKER",
            "id":"lightbend/trainingdataingestion:1.3.1",
            "forcePull": true
	    
         },
         "volumeMounts":[
            {
               "name":"data",
               "mountPath":"/usr/share"
            }
         ],
         "labels":{
            "c1_label":"c1"
         }
      },
      {
         "name":"training",
         "exec":{
            "command":{
               "shell":"./analytics-zoo/scripts/wait-and-start-training.sh"
            }
         },
         "resources":{
            "cpus":0.5,
            "mem":4096,
            "disk":1024
         },
         "endpoints":[
         ],
         "image":{
            "kind":"DOCKER",
            "id":"lightbend/analytics-zoo:0.1.1-spark-2.2.0",
            "forcePull": true
         },
         "volumeMounts":[
            {
               "name":"data",
               "mountPath":"/usr/share"
            }
         ],
         "labels":{
            "c1_label":"c1"
         }
      },
      {
         "name":"publishdata",
         "exec":{
            "command":{
               "shell":"while true; do while [ ! -f $TRAINING_COMPLETE_FILE_NAME ]; do sleep 2; done; echo Got $TRAINING_COMPLETE_FILE_NAME; /training_model_publish/bin/trainingmodelpublish && rm $TRAINING_COMPLETE_FILE_NAME; done"
            }
         },
         "resources":{
            "cpus":0.5,
            "mem":4096,
            "disk":32
         },
         "endpoints":[
         ],
         "image":{
            "kind":"DOCKER",
            "id":"lightbend/trainingmodelpublish:1.3.1",
            "forcePull": true
	    
         },
         "volumeMounts":[
            {
               "name":"data",
               "mountPath":"/usr/share"
            }
         ],
         "labels":{
            "c1_label":"c1"
         }
      }
   ],
   "volumes":[
      {
         "name":"data"
      }
   ],
   "networks":[
      {
         "mode":"host"
      }
   ],
   "scaling":{
      "kind":"fixed",
      "instances":1
   }
}

